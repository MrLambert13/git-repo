<meta charset="utf-8">
<script>
	//фунеция выбора из диапазона
	function getRandomInt (min, max){
		return Math.floor(Math.random() * (max - min + 1)) + min;
	}

	//список карт и получение одной рандомно
	function getCart () {
		var cards = ['6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'];
		return cards [getRandomInt(0, cards.length - 1)];
	}

	//подсчет суммы карт на руках
	function getSumm (arr) {
		var sum= 0;
		var i;

		for (i = 0; i < arr.length; i++){  //сначала считаем всё кроме туза
			if (arr[i] != 'A') {
				if (!isNaN (arr[i])) {
					sum = sum + parseInt (arr[i]);
				} else {
					sum = sum + 10;
				}
			}
		} 

		for (i = 0; i < arr.length; i++) { //теперь считаем тузы
			if (arr[i] == 'A') {
				if (sum > 10) {
					sum++;
				} else {
					sum = sum +11;
				}
			}
		}
		
		return sum;
	}

	function getStatus (arr) { //сообщение с наименование карт и суммы очков
		return ("Игрок: " + player.join (' ') + ', Сумма: ' + getSumm (player) +
				" || Дилер: " + dealer.join (' ') + ', Сумма: ' + getSumm (dealer));
	}




	do { // начало игры
		var dealer = [getCart()];
		var player = [getCart(), getCart()];
		//var player = ['A', 'Q']; //тестовая строка
		var symP = 0;
		var sumD = 0;
		
		if (getSumm(player) == 21) {
			alert ('WOW! БлэкДжэк с раздачи! Да ты невероятно везучь! ' + getStatus());
		} else {
			
			do {
				var answer = prompt ( getStatus() + '. Ещё карту ? (1 - да, иначе - нет)');
				if (answer == '1') {
					player.push (getCart());
				} else {
					while (getSumm(dealer) < 17) {
						dealer.push (getCart());
					}
					sumP = getSumm(player);
					sumD = getSumm(dealer);

					if (sumD < 21) {
						if(sumD > sumP) {
						alert('Ты проиграл! ' + getStatus());
						} else if (sumP == sumD) {
							alert('Ничья! ' + getStatus());
						} else {
							alert('Ты выиграл! ' + getStatus());
						} else {
							alert('Победа!  Дилер перебрал. ' + getStatus())
						}
					}
				}

				sumP = getSumm(player);
				if (sumP == 21) {
					alert ("Блэкджек! Вы побеждаете!" + getStatus());
					break;
				} else if (sumP > 21) {
					alert ("Увы перебор! Вы проиграли" + getStatus());
					break;
				} 

			} while	(answer == '1')

			
		}

		

		answer = prompt("Сыгрыем еще? (1 - да, иначе нет)");

	} while (answer == 1);
</script>